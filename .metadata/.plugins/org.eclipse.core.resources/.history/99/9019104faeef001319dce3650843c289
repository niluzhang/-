package net;

import java.io.IOException;

import test.TestMessage1;
import test.TestMessage2;

import message.LoginBackMessage;
import message.LoginMessage;

public class Test {

	public static Test test;
	public Net net;
	public Object lock = new Object();;

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		test = new Test();
		test.go();
	}

	public void go() {
		try {
			net = new Net();
			Thread1 t1 = new Thread1();
			Thread2 t2 = new Thread2();

			t1.start();
			t2.start();
			// t3.start();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public class Thread1 extends Thread {
		public void run() {
			int i = 0;
			while (true) {
				synchronized (lock) {
					lock.notifyAll();
					net.sendMessage(new TestMessage1());
					TestMessage1 lbm = (TestMessage1) net.getMessage(3);
					if (lbm != null)
						System.out.println(lbm.hahaha + " " + lbm.id + " "
								+ lbm.info + " " + lbm.nunu);
					try {
						lock.wait();
					} catch (InterruptedException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
			}
		}
	}

	public class Thread2 extends Thread {
		public void run() {
			int i = 0;
			while (true) {
				synchronized (lock) {
					lock.notifyAll();
					net.sendMessage(new TestMessage2());
					TestMessage2 lbm = (TestMessage2) net.getMessage(-1000);
					if (lbm != null)
						System.out.println(lbm.hahaha + " " + lbm.id + " "
								+ lbm.info);
					try {
						lock.wait();
					} catch (InterruptedException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
			}
		}
	}

}
